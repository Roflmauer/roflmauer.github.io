<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Data - Pierre Meyer</title>
    <link href="styles.css" rel="stylesheet">
</head>
<body>
<header>
    <div class="container">
        <h1>Financial Data</h1>
        <p>Real-time global index performances</p>
    </div>
</header>

<main class="container">
    <table>
        <thead>
            <tr>
                <th>Index</th>
                <th>Current Price</th>
                <th>Change</th>
            </tr>
        </thead>
        <tbody id="index-data">
            <!-- Data will be inserted here -->
        </tbody>
    </table>
</main>

<footer>
    <div class="container">
        <p>Â© 2025 Pierre Meyer | <a href="index.html">Back to Home</a></p>
    </div>
</footer>

<script>
// Replace 'YOUR_API_KEY' with your actual Twelve Data API key
const API_KEY = 'a1a07421230e434985b70d6f8a5e9532';

const indices = {
    "Germany (DAX)": "DAX",
    "Taiwan (TAIEX)": "TWII",
    "United States (S&P 500)": "SPX",
    "United Kingdom (FTSE 100)": "FTSE",
    "Japan (Nikkei 225)": "N225",
    "France (CAC 40)": "FCHI",
    "Hong Kong (Hang Seng Index)": "HSI",
    "India (Sensex)": "SENSEX",
    "Australia (ASX 200)": "AXJO",
    "China (SSE Composite Index)": "000001.SS"
};

async function fetchIndexData(symbol) {
    try {
        const response = await fetch(`https://api.twelvedata.com/quote?symbol=${symbol}&apikey=${API_KEY}`);
        const data = await response.json();

        // Check if the response has the expected structure
        if (!data || !data.close || !data.price) {
            console.error("Unexpected data format:", data);
            return null;
        }

        const lastClose = parseFloat(data.close);
        const currentPrice = parseFloat(data.price);
        const change = currentPrice - lastClose;
        const changePercent = ((change / lastClose) * 100).toFixed(2);

        return {
            price: currentPrice.toFixed(2),
            change: change.toFixed(2),
            changePercent: changePercent
        };
    } catch (error) {
        console.error("Error fetching index data:", error);
        return null;
    }
}

async function updateTable() {
    const tableBody = document.getElementById("index-data");
    tableBody.innerHTML = "";

    for (const [country, symbol] of Object.entries(indices)) {
        const data = await fetchIndexData(symbol);
        if (data) {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${country}</td>
                <td>$${data.price}</td>
                <td class="${data.change > 0 ? 'positive' : 'negative'}">${data.change} (${data.changePercent}%)</td>
            `;
            tableBody.appendChild(row);
        }
    }
}

// Initial load
updateTable();

// Update every 60 seconds
setInterval(updateTable, 60000);
</script>

</body>
</html>
